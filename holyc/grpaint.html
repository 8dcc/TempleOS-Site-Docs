<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-holyc/grpaint">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<title data-rh="true">Make an Example App | TempleOS Simplified</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://templeos.me/holyc/grpaint"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Make an Example App | TempleOS Simplified"><meta data-rh="true" name="description" content="You can make your own apps in TempleOS. Doing so is fun once you get the hang of it,but you will need to get started. In this tutorial,you will learn to make an example program called GrPaint. It&#x27;s like microsoft paint but for TempleOS."><meta data-rh="true" property="og:description" content="You can make your own apps in TempleOS. Doing so is fun once you get the hang of it,but you will need to get started. In this tutorial,you will learn to make an example program called GrPaint. It&#x27;s like microsoft paint but for TempleOS."><link data-rh="true" rel="icon" href="/logos/HolyC.png"><link data-rh="true" rel="canonical" href="https://templeos.me/holyc/grpaint"><link data-rh="true" rel="alternate" href="https://templeos.me/holyc/grpaint" hreflang="en"><link data-rh="true" rel="alternate" href="https://templeos.me/holyc/grpaint" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.9a7210a5.css">
<link rel="preload" href="/assets/js/runtime~main.f7de32a9.js" as="script">
<link rel="preload" href="/assets/js/main.24907cfa.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logos/HolyC.png" alt="HolyC Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/logos/HolyC.png" alt="HolyC Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">TempleDocs</b></a><a class="navbar__item navbar__link" sidebarid="guide" href="/guide/intro">Guide</a><a class="navbar__item navbar__link" sidebarid="holyc" href="/holyc/intro">HolyC</a><a class="navbar__item navbar__link" sidebarid="config" href="/Keybinding">Keybinding</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/templeos-simplified/site-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"></a><a href="https://discord.gg/Epu3WxjaP7" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"></a><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/intro">HolyC Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/getting-started-hc">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/primer">HolyC Primer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/printing">Printing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/memory">Memory Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/datastructs">Data Structures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/graphics">Graphics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/sound">Sound</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/doldoc">DolDoc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/input">User Input</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/holyc/multic">Multi-Threading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/holyc/grpaint">Make an Example App</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_nDMA"><div class="docItemContainer_p3Qu"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Make an Example App</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_diN6"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Making an Example App</h1><p>You can make your own apps in TempleOS. Doing so is fun once you get the hang of it,but you will need to get started. In this tutorial,you will learn to make an example program called <code>GrPaint</code>. It&#x27;s like microsoft paint but for TempleOS.
In this tutorial,we will learn about:</p><ul><li>User input</li><li>Graphics,</li><li>Circular Queues</li><li>Basic file stuff.
Ok time to rock.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setupclasses-1">Setup(Classes 1).<a class="hash-link" href="#setupclasses-1" title="Direct link to heading">​</a></h2><p>In our app,we will define some data structures in a <code>class</code>. A class holds data and looks like this</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">class </span><span class="token class-name" style="color:rgb(255, 203, 107)">CName</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> a</span><span class="token punctuation">,</span><span class="token plain">b</span><span class="token punctuation">,</span><span class="token plain">c</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> d</span><span class="token punctuation">,</span><span class="token plain">e</span><span class="token punctuation">,</span><span class="token plain">f</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A class has a name and some members,my main class looks like this.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">extern class </span><span class="token class-name" style="color:rgb(255, 203, 107)">CEditLayer</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class </span><span class="token class-name" style="color:rgb(255, 203, 107)">CGrPaint</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//state is the current state(defined later).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//dft_action is the default action to do(like fill or brush)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> state</span><span class="token punctuation">,</span><span class="token plain">dft_action</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> w</span><span class="token punctuation">,</span><span class="token plain">h</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> mouse_x</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> mouse_y</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Bit 1 is right</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Bit 0 is left</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> mouse_buttons</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> cur_color</span><span class="token punctuation">,</span><span class="token plain">cur_thick</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> _brush_x</span><span class="token punctuation">,</span><span class="token plain">_brush_y</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  CEditLayer </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">edits</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">picture</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">U8</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">filename</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"> gr_paint</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Fill gr_paint will 0&#x27;s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(207, 130, 255)">MemSet</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">gr_paint</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token plain">sizeof</span><span class="token punctuation">(</span><span class="token plain">CGrPaint</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Sometimes we want to represent something(like the current state) with a number,but it may get tedious to remember the numbers. For this we use...</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="macros">Macros<a class="hash-link" href="#macros" title="Direct link to heading">​</a></h2><p>Macros are pieces of text that get inserted into the source code. Here,I to hold the state numbers in a clean way.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define PS_NONE </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//PS means Paint State</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define PS_BRUSH </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define PS_FILL </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define PS_UNDO </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But you can put any text in a macro. Let&#x27;s see an example</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define TEXT </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;I love onions&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token string" style="color:rgb(232, 208, 141)">&quot;%s\n&quot;</span><span class="token punctuation">,</span><span class="token plain">TEXT</span><span class="token punctuation">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s define some more macros for our project</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define COLOR_BOX_WIDTH </span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define SIDE_BAR_WIDTH </span><span class="token punctuation">(</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token number" style="color:rgb(247, 140, 108)">8</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define TOP_BAR_HEIGHT </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define PIC_W </span><span class="token punctuation">(</span><span class="token plain">GR_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">SIDE_BAR_WIDTH</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define PIC_H </span><span class="token punctuation">(</span><span class="token plain">GR_HEIGHT</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">TOP_BAR_HEIGHT</span><span class="token punctuation">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setupclasses-2">Setup(Classes 2)<a class="hash-link" href="#setupclasses-2" title="Direct link to heading">​</a></h2><p>Sometimes we want to use an existing class as a base type for a new class. We can do this via inheritance. <strong>Inheritance will add all the members from a base class to another class</strong>. It is very epic. Let&#x27;s see an example:</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">class </span><span class="token class-name" style="color:rgb(255, 203, 107)">ABC</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> a</span><span class="token punctuation">,</span><span class="token plain">b</span><span class="token punctuation">,</span><span class="token plain">c</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Inherited class after &#x27;:&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class </span><span class="token class-name" style="color:rgb(255, 203, 107)">ABCDEF</span><span class="token punctuation">:</span><span class="token plain">ABC </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> d</span><span class="token punctuation">,</span><span class="token plain">e</span><span class="token punctuation">,</span><span class="token plain">f</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ABC abc</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">abc</span><span class="token punctuation">.</span><span class="token plain">a</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">abc</span><span class="token punctuation">.</span><span class="token plain">b</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">abc</span><span class="token punctuation">.</span><span class="token plain">c</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ABCDEF abcdef</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//We get &#x27;a&#x27; from ABC,and the ABC class starts at the address of abcdef</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">abcdef</span><span class="token punctuation">.</span><span class="token plain">a</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">abcdef</span><span class="token punctuation">.</span><span class="token plain">d</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">abcdef</span><span class="token punctuation">.</span><span class="token plain">e</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">abcdef</span><span class="token punctuation">.</span><span class="token plain">f</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token punctuation">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setupcircular-queues">Setup(Circular Queues)<a class="hash-link" href="#setupcircular-queues" title="Direct link to heading">​</a></h2><p>In our App,I use <code>CQue</code> as a base class for our edits,and when we inherit from a base class,we can use the <strong>class like the base class via a pointer as the base class gets stored at the start of the new class</strong>.
So let&#x27;s see some code:</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">class </span><span class="token class-name" style="color:rgb(255, 203, 107)">CEditLayer</span><span class="token punctuation">:</span><span class="token plain">CQue </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">dc</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> NewUndoLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  CEditLayer </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token keyword" style="color:rgb(130, 170, 255)">new</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(207, 130, 255)">CAlloc</span><span class="token punctuation">(</span><span class="token plain">sizeof CEditLayer</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Allocate memory for new edit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//QueInit takes a pointer to CQue,but it is okay to use CEditLayer as it has a base class of CQue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">QueInit</span><span class="token punctuation">(</span><span class="token keyword" style="color:rgb(130, 170, 255)">new</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">QueIns</span><span class="token punctuation">(</span><span class="token keyword" style="color:rgb(130, 170, 255)">new</span><span class="token punctuation">,</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">edits</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">last</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">new</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">dc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(207, 130, 255)">DCCopy</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> UndoEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_NONE</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we insert the <code>new</code> edit into the chain. A circular queue has a head element and it&#x27;s buddies. <code>gr_paint.edits</code> is the head element,and it has a pointer to it&#x27;s last element in <code>last</code>.</p><p>When we want to add an item,use <code>QueIns(new,at);</code>. Here will use <code>gr_paint.edits-&gt;last</code> to insert our new edit at the end of the chain.</p><p><img loading="lazy" alt="Wrap around" src="/assets/images/cque_wrap_around-d042e81d3909c223c0479758ff6c46c9.png" width="1401" height="657" class="img_ev3q"></p><p>But wait,what about undo&#x27;ing.. Glad you asked:.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">extern </span><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> Redraw</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(130, 170, 255)">Bool</span><span class="token plain"> bg</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> StartUndo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  CEditLayer </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">edit</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">PS_UNDO</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_UNDO</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    edit</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">edits</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">last</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">edit</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">edits</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Check if not head element</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token builtin" style="color:rgb(207, 130, 255)">QueRem</span><span class="token punctuation">(</span><span class="token plain">edit</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token builtin" style="color:rgb(207, 130, 255)">DCDel</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">edit</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">dc</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token builtin" style="color:rgb(207, 130, 255)">Free</span><span class="token punctuation">(</span><span class="token plain">edit</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      Redraw</span><span class="token punctuation">(</span><span class="token plain">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Ignore this,it just ends the undo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> EndUndo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_NONE</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It may be alot to take in,but ill explain. To remove an item from the <code>CQue</code>,use <code>QueRem</code>. But things get a little tricky here. <strong>BE SURE TO NOT DELETE THE HEAD ELEMENT</strong>. Elements in a <code>CQue</code> are <strong>Circular</strong>,meaning the chain loops around.
So the <code>gr_paint.edits-&gt;last</code> will point to the head if the chain is <em>empty</em>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="graphics-time">Graphics time<a class="hash-link" href="#graphics-time" title="Direct link to heading">​</a></h2><p>Graphics in TempleOS are very easy to use,we can draw a rectangle to the screen via <code>GrRect</code>(and freinds),but we will first need to specify the color first on the global <code>CDC</code>(known as <code>gr.dc</code>)</p><p>Lets see an example:</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gr</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">RED</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(207, 130, 255)">GrRect</span><span class="token punctuation">(</span><span class="token plain">gr</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(207, 130, 255)">Sleep</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(247, 140, 108)">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Sleep for 1000 milliseconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(207, 130, 255)">DCFill</span><span class="token punctuation">(</span><span class="token plain">gr</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token plain">TRANSPARENT</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Most programs typically have a user interface,so let&#x27;s draw a color chooser. I will add logic for handling the mouse during this draw routine too,but don&#x27;t panic as it will be described later</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> DrawColorBar</span><span class="token punctuation">(</span><span class="token plain">CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> x</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> y</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Draw a grid with the colors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">/*</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic"> This is what it looks like</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">  _____</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">  | | |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">  | | |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">  =====</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">  | | |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">  | | |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">  =====</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">   ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">   ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">  =====</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> x2</span><span class="token punctuation">,</span><span class="token plain">y2</span><span class="token punctuation">,</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token plain">bx</span><span class="token punctuation">,</span><span class="token plain">by</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">for</span><span class="token punctuation">(</span><span class="token plain">y2</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">;</span><span class="token plain">y2</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token number" style="color:rgb(247, 140, 108)">8</span><span class="token punctuation">;</span><span class="token plain">y2</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Loop for each row</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">for</span><span class="token punctuation">(</span><span class="token plain">x2</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">;</span><span class="token plain">x2</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation">;</span><span class="token plain">x2</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Loop for each column</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">thick</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">BLACK</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Draw border(center will be filled with color later)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token builtin" style="color:rgb(207, 130, 255)">GrRect</span><span class="token punctuation">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dc</span><span class="token punctuation">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        x</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">x2</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">COLOR_BOX_WIDTH</span><span class="token punctuation">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        y</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">y2</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">COLOR_BOX_WIDTH</span><span class="token punctuation">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        COLOR_BOX_WIDTH</span><span class="token punctuation">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        COLOR_BOX_WIDTH</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//If mouse is down,we assign the color</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      bx</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">x2</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">COLOR_BOX_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      by</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">y2</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">COLOR_BOX_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Bt tests if a bit is set,we use it here to check if we are clicking-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">Bt</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_buttons</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">bx</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_x</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">bx</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">COLOR_BOX_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">by</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_y</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">by</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">COLOR_BOX_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            gr_paint</span><span class="token punctuation">.</span><span class="token plain">cur_color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">color</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Fill in the center</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token builtin" style="color:rgb(207, 130, 255)">GrRect</span><span class="token punctuation">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        dc</span><span class="token punctuation">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        x</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">x2</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">COLOR_BOX_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        y</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">y2</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">COLOR_BOX_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        COLOR_BOX_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        COLOR_BOX_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">return</span><span class="token plain"> y</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">y2</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">COLOR_BOX_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We will need a tools ,And we can draw the tool&#x27;s name via <code>GrPrint(dc,x,y&quot;text&quot;);</code></p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> DrawTool</span><span class="token punctuation">(</span><span class="token plain">CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> x</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> y</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(130, 170, 255)">U8</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">name</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> tool</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> len</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(207, 130, 255)">StrLen</span><span class="token punctuation">(</span><span class="token plain">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">dft_action</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">tool</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">BLUE</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">GrRect</span><span class="token punctuation">(</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token plain">x</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">,</span><span class="token plain">SIDE_BAR_WIDTH</span><span class="token punctuation">,</span><span class="token plain">FONT_HEIGHT</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">RED</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(130, 170, 255)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">BLACK</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">GrPrint</span><span class="token punctuation">(</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token plain">x</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">,</span><span class="token plain">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">Bt</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_buttons</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_x</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">SIDE_BAR_WIDTH</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_y</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">FONT_HEIGHT</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        gr_paint</span><span class="token punctuation">.</span><span class="token plain">dft_action</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">tool</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">return</span><span class="token plain"> y</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">FONT_HEIGHT</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s throw in both these functions into a function</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> DrawUI</span><span class="token punctuation">(</span><span class="token plain">CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">dc</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">WHITE</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">GrRect</span><span class="token punctuation">(</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token plain">SIDE_BAR_WIDTH</span><span class="token punctuation">,</span><span class="token plain">GR_HEIGHT</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">CYAN</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">GrPrint</span><span class="token punctuation">(</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Tool&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">FONT_HEIGHT</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">DrawColorBar</span><span class="token punctuation">(</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">DrawTool</span><span class="token punctuation">(</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">,</span><span class="token string" style="color:rgb(232, 208, 141)">&quot;[Pnt]&quot;</span><span class="token punctuation">,</span><span class="token plain">PS_BRUSH</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">DrawTool</span><span class="token punctuation">(</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">,</span><span class="token string" style="color:rgb(232, 208, 141)">&quot;[Fll]&quot;</span><span class="token punctuation">,</span><span class="token plain">PS_FILL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="user-input">User Input<a class="hash-link" href="#user-input" title="Direct link to heading">​</a></h2><p>User input in TempleOS is typically handled via events. We can look at events via <code>ScanMsg</code>,or if we want keys we can use <code>ScanKey(I64 *charactor,I64 *scancode)</code>. A scancode is the raw key from the keybaord and the readable charactor.
Let&#x27;s see an example of getting user input,but first know that <strong>while looping for input you should use <code>Refresh</code> to allow TempleOS to refresh the screen</strong>. Lets get started</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> InputLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> ch</span><span class="token punctuation">,</span><span class="token plain">sc</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">while</span><span class="token punctuation">(</span><span class="token plain">TRUE</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">ScanKey</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">ch</span><span class="token punctuation">,</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">sc</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token string" style="color:rgb(232, 208, 141)">&#x27;Q&#x27;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Quiting\n&quot;</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="color:rgb(130, 170, 255)">break</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(130, 170, 255)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Got a &#x27;%C&#x27;\n&quot;</span><span class="token punctuation">,</span><span class="token plain">ch</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">Refresh</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">InputLoop</span><span class="token punctuation">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we only checked for a charactor,but what about <em>scancodes</em>. Ill explain. A scancode has flags and a unique value. A flag tells you what modifier key is down,like <code>SCF_SHIFT</code>,<code>SCF_CTRL</code>,or <code>SCF_ALT</code>. We can can test for a flag by using the <code>&amp;</code> operator.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//DONT COPY TTHIS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> InputLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> ch</span><span class="token punctuation">,</span><span class="token plain">sc</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">while</span><span class="token punctuation">(</span><span class="token plain">TRUE</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">ScanKey</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">ch</span><span class="token punctuation">,</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">sc</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token string" style="color:rgb(232, 208, 141)">&#x27;Q&#x27;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Quiting\n&quot;</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="color:rgb(130, 170, 255)">break</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(130, 170, 255)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token punctuation">(</span><span class="token plain">SCF_SHIFT</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">sc</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Got a &#x27;%C&#x27;(No SHIFT key)\n&quot;</span><span class="token punctuation">,</span><span class="token plain">ch</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Got a &#x27;%C&#x27;(SHIFT key)\n&quot;</span><span class="token punctuation">,</span><span class="token plain">ch</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">Refresh</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">InputLoop</span><span class="token punctuation">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can get the mouse cordnates on a window via <code>ScanMsg</code>,or if you want to system mouse cornates you can do <code>ms.pos.x</code>/<code>ms.pos.y</code>,you can check the buttons via <code>ms.lb</code>/<code>ms.rb </code>
Let&#x27;s What our input loop looks like.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> GrPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">while</span><span class="token punctuation">(</span><span class="token plain">TRUE</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_x</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ms</span><span class="token punctuation">.</span><span class="token plain">pos</span><span class="token punctuation">.</span><span class="token plain">x</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ms</span><span class="token punctuation">.</span><span class="token plain">pos</span><span class="token punctuation">.</span><span class="token plain">y</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">BEqu</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_buttons</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token plain">ms</span><span class="token punctuation">.</span><span class="token plain">lb</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">BEqu</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_buttons</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">,</span><span class="token plain">ms</span><span class="token punctuation">.</span><span class="token plain">rb</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    DrawUI</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ms</span><span class="token punctuation">.</span><span class="token plain">lb</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">ScanKey</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">ch</span><span class="token punctuation">,</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">sc</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">CH_CTRLF</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tool-timebrush">Tool time(Brush)<a class="hash-link" href="#tool-timebrush" title="Direct link to heading">​</a></h2><p>A paint program needs tools. So let&#x27;s make the most basic tool: <em>the brush</em>. In our app,we have states,and <code>PS_BRUSH</code> is our brush state. We will <code>StartBrushPaint()</code> when we start a stroke,and must end the stroke with <code>EndBrushPaint()</code>. We will also update the stoke every mouse move with <code>ContinueBrushPaint()</code>.</p><p>In our <code>StartBrushPaint</code>,we make an undo layer ,and then we set the brush cordnates.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> StartBrushPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_BRUSH</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">_brush_x</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_x</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">_brush_y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_y</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  NewUndoLayer</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>ContinueBrushPaint</code> will draw a line for the stoke if we have moved the mouse.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> ContinueBrushPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> ox</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">_brush_x</span><span class="token punctuation">,</span><span class="token plain">oy</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">_brush_y</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_x</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token punctuation">(</span><span class="token plain">ox</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">_brush_x</span><span class="token punctuation">)</span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_y</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token punctuation">(</span><span class="token plain">oy</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">_brush_y</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">thick</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">cur_thick</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">cur_color</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gr_paint</span><span class="token punctuation">.</span><span class="token plain">_brush_x</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_x</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gr_paint</span><span class="token punctuation">.</span><span class="token plain">_brush_y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_y</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">GrLine3</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token punctuation">,</span><span class="token plain">ox</span><span class="token punctuation">,</span><span class="token plain">oy</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">_brush_x</span><span class="token punctuation">,</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">_brush_y</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Redraw</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we used <code>GrLine3</code> to do some epic line drawing. We can we set the thickness and color with <code>CDC.cur_color</code> and <code>CDC.thick</code>.</p><p>And finaly we end the state via</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> EndBrushPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_NONE</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tool-time-2fill-tool">Tool Time 2(Fill tool)<a class="hash-link" href="#tool-time-2fill-tool" title="Direct link to heading">​</a></h2><p>This tool is pretty easy,use <code>GrFloodFill</code>.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> FillToolStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  NewUndoLayer</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_FILL</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">cur_color</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">GrFloodFill</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token punctuation">,</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_x</span><span class="token punctuation">,</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_y</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Redraw</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> FillToolEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_NONE</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tool-time-3undo">Tool Time 3(Undo)<a class="hash-link" href="#tool-time-3undo" title="Direct link to heading">​</a></h2><p>See the code from <a href="#Setup(Circular-Queues)">Setup(Circular-Queues)</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="user-input-2menus">User Input 2,Menus<a class="hash-link" href="#user-input-2menus" title="Direct link to heading">​</a></h2><p>TempleOS has a menu system. You can hold down the logo key to access the menu and it looks something like this:
<a href="/holyc/todo.jpeg">img</a></p><p>We can push a menu to TempleOS with <code>MenuPush</code>. But first we need to know how menus work. Menus work by sending events to the current task. These messages are <code>MSG_KEY_DOWN</code>,and the arguments are the charactor and scancode. Let&#x27;s see an example.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> MenuLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> ch</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">MenuPush</span><span class="token punctuation">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;File {&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//1st is message(Default is MSG_KEY_DOWN)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//2nd is charctor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//3rd is scancode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;  Exit(,CH_SHIFT_ESC,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Fruit {&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;    Apple(,&#x27;apple&#x27;,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;    Banana(,&#x27;banana&#x27;,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;    Berry(,&#x27;berry&#x27;,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Vegetable {&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;    Carrot(,&#x27;carrot&#x27;,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;    Celery(,&#x27;celery&#x27;,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Access stuff from the menu!!\n&quot;</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">while</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(207, 130, 255)">GetKey</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">CH_SHIFT_ESC</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(130, 170, 255)">break</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Got a %c\n&quot;</span><span class="token punctuation">,</span><span class="token plain">ch</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">MenuPop</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MenuLoop</span><span class="token punctuation">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s look at our init code</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">edits</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(207, 130, 255)">CAlloc</span><span class="token punctuation">(</span><span class="token plain">sizeof</span><span class="token punctuation">(</span><span class="token plain">CQue</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">gr</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(207, 130, 255)">DCNew</span><span class="token punctuation">(</span><span class="token plain">GR_WIDTH</span><span class="token punctuation">,</span><span class="token plain">GR_HEIGHT</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">QueInit</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">edits</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Fill with transparent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">DCFill</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">DCFill</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">WinBorder</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">WinMax</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">MenuPush</span><span class="token punctuation">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;File {&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;    Save(,CH_CTRLS,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;    Exit(,CH_ESC,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;    Abort(,CH_SHIFT_ESC,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;Edit {&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;    Brush(,CH_CTRLB,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;    Fill(,CH_CTRLF,);&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(232, 208, 141)">&quot;}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-epic-background-pattern">Creating an Epic Background Pattern<a class="hash-link" href="#creating-an-epic-background-pattern" title="Direct link to heading">​</a></h2><p>Our backround could be all white,but that wouldn&#x27;t be too fun,so I will make a checkerboard pattern. A key aspect of this pattern is switching the color on and off. Luckily computers can do this via a bitwise operator. This operator is called an XOR operator and looks like this in HolyC <code>^</code>.</p><p>An XOR operator will toggle the other bit if a bit is set. Let&#x27;s see it in table form:
|A|B|Result|
|--|--|--|
|1|1|0|
|1|0|1|
|0|1|1|
|0|0|0|
Here,I XOR with 1,and by doing so the value will turn off or on,let&#x27;s see the nlock</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> DrawCheckers</span><span class="token punctuation">(</span><span class="token plain">CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> x</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> y</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> w</span><span class="token punctuation">,</span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> h</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define CHECKER_WIDTH </span><span class="token number" style="color:rgb(247, 140, 108)">14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Draw a checker board pettern</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> blink</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">FALSE</span><span class="token punctuation">,</span><span class="token plain">blink2</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">FALSE</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> color</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> x2</span><span class="token punctuation">,</span><span class="token plain">y2</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">for</span><span class="token punctuation">(</span><span class="token plain">x2</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">x</span><span class="token punctuation">;</span><span class="token plain">x2</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">w</span><span class="token punctuation">;</span><span class="token plain">x2</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">CHECKER_WIDTH</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//XORing toggles a bit,so we XOR with TRUE to toggle it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    blink</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">blink2</span><span class="token operator" style="color:rgb(137, 221, 255)">^</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">TRUE</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">for</span><span class="token punctuation">(</span><span class="token plain">y2</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">y</span><span class="token punctuation">;</span><span class="token plain">y2</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">w</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">h</span><span class="token punctuation">;</span><span class="token plain">y2</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">CHECKER_WIDTH</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">blink</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        blink</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">FALSE</span><span class="token punctuation">,</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">LTGRAY</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        blink</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">TRUE</span><span class="token punctuation">,</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">WHITE</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">color</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token builtin" style="color:rgb(207, 130, 255)">GrRect</span><span class="token punctuation">(</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token plain">x2</span><span class="token punctuation">,</span><span class="token plain">y2</span><span class="token punctuation">,</span><span class="token plain">CHECKER_WIDTH</span><span class="token punctuation">,</span><span class="token plain">CHECKER_WIDTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="putting-it-all-togheter">Putting it all Togheter<a class="hash-link" href="#putting-it-all-togheter" title="Direct link to heading">​</a></h2><p>We will need to be able save the file. Luckily for us we can save a <code>CDC</code> with <code>GRWrite(filename,dc);</code> but we will need get a filename first. We can get a pop-up window with <code>PopUpFileName(default);</code>. Will will need to clear the graphics off the screen so we can look at the window first,so we <code>DCFill</code></p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">extern CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">AutoCrop</span><span class="token punctuation">(</span><span class="token plain">CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">img</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> SaveFileAs</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(130, 170, 255)">Bool</span><span class="token plain"> prompt</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">TRUE</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">dc</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">prompt</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">Free</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">DCFill</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">prompt</span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">filename</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">filename</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(207, 130, 255)">PopUpFileName</span><span class="token punctuation">(</span><span class="token string" style="color:rgb(232, 208, 141)">&quot;DRAWING.GR&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//We will define AutoCrop later</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  dc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">AutoCrop</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">filename</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">GRWrite</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">filename</span><span class="token punctuation">,</span><span class="token plain">dc</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">DCDel</span><span class="token punctuation">(</span><span class="token plain">dc</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Redraw</span><span class="token punctuation">(</span><span class="token plain">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It would be strange to save the area around the image,so we will make a function to crop the image for us. Here will will use <code>GrPeek0</code> and <code>GrPlot0</code>. These do not apply transformations and are relativly fast.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">AutoCrop</span><span class="token punctuation">(</span><span class="token plain">CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">img</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> x</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">,</span><span class="token plain">top</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">,</span><span class="token plain">left</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">,</span><span class="token plain">bottom</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">I64_MIN</span><span class="token punctuation">,</span><span class="token plain">right</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">I64_MIN</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">dc</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">for</span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">SIDE_BAR_WIDTH</span><span class="token punctuation">;</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">PIC_W</span><span class="token punctuation">;</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Image includes sidebar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">for</span><span class="token punctuation">(</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">;</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">PIC_H</span><span class="token punctuation">;</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">top</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">top</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">GrPeek0</span><span class="token punctuation">(</span><span class="token plain">img</span><span class="token punctuation">,</span><span class="token plain">x</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">)</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">TRANSPARENT</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        top</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">y</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">left</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">left</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">GrPeek0</span><span class="token punctuation">(</span><span class="token plain">img</span><span class="token punctuation">,</span><span class="token plain">x</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">)</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">TRANSPARENT</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        left</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">x</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">GrPeek0</span><span class="token punctuation">(</span><span class="token plain">img</span><span class="token punctuation">,</span><span class="token plain">x</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">)</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">TRANSPARENT</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">right</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">x</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         right</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">x</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">GrPeek0</span><span class="token punctuation">(</span><span class="token plain">img</span><span class="token punctuation">,</span><span class="token plain">x</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">)</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">TRANSPARENT</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">bottom</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">y</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         bottom</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">y</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">top</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain">left</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">return</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(207, 130, 255)">DCNew</span><span class="token punctuation">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  dc</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(207, 130, 255)">DCNew</span><span class="token punctuation">(</span><span class="token plain">right</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">left</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">,</span><span class="token plain">bottom</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">top</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">for</span><span class="token punctuation">(</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">left</span><span class="token punctuation">;</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">right</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">;</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">for</span><span class="token punctuation">(</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">top</span><span class="token punctuation">;</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">bottom</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">;</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">color</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(207, 130, 255)">GrPeek0</span><span class="token punctuation">(</span><span class="token plain">img</span><span class="token punctuation">,</span><span class="token plain">x</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token builtin" style="color:rgb(207, 130, 255)">GrPlot0</span><span class="token punctuation">(</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token plain">x</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">left</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">top</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">return</span><span class="token plain"> dc</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Sometimes we need to repaint the screen,so let&#x27;s do that</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> FastPutPicture</span><span class="token punctuation">(</span><span class="token plain">CDC </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">picture</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> p</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">for</span><span class="token punctuation">(</span><span class="token plain">p</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">;</span><span class="token plain">p</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">GR_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">GR_HEIGHT</span><span class="token punctuation">;</span><span class="token plain">p</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">picture</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">body</span><span class="token punctuation">[</span><span class="token plain">p</span><span class="token punctuation">]</span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain">TRANSPARENT</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      gr</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">body</span><span class="token punctuation">[</span><span class="token plain">p</span><span class="token punctuation">]</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">picture</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">body</span><span class="token punctuation">[</span><span class="token plain">p</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> Redraw</span><span class="token punctuation">(</span><span class="token variable" style="color:rgb(130, 170, 255)">Bool</span><span class="token plain"> bg</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">FALSE</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">bg</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    DrawCheckers</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token punctuation">,</span><span class="token plain">SIDE_BAR_WIDTH</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token plain">PIC_W</span><span class="token punctuation">,</span><span class="token plain">PIC_H</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  FastPutPicture</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">picture</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  DrawUI</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We should cleanup when we exit the program. Each TempleOS <code>CTask</code> has a <code>task_end_cb</code>,which takes a fun ction address which will can get via the <code>&amp;</code> operator. Fs points to the current <code>CTask</code></p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> DeInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">MenuPop</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">DCFill</span><span class="token punctuation">(</span><span class="token plain">gr</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> GrPaintExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">Exit</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//We will put this in the GrPaint function later</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Fs-&gt;task_end_cb=&amp;DeInit;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And finally we need the <code>GrPaint</code> logic.</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token variable" style="color:rgb(130, 170, 255)">U0</span><span class="token plain"> GrPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token variable" style="color:rgb(130, 170, 255)">I64</span><span class="token plain"> x</span><span class="token punctuation">,</span><span class="token plain">y</span><span class="token punctuation">,</span><span class="token plain">res</span><span class="token punctuation">,</span><span class="token plain">ch</span><span class="token punctuation">,</span><span class="token plain">sc</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  CEditLayer </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">edit</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">AutoComplete</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Init</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">dft_action</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_BRUSH</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin" style="color:rgb(207, 130, 255)">Fs</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">task_end_cb</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">DeInit</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gr_paint</span><span class="token punctuation">.</span><span class="token plain">cur_thick</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Redraw</span><span class="token punctuation">(</span><span class="token plain">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="color:rgb(130, 170, 255)">while</span><span class="token punctuation">(</span><span class="token plain">TRUE</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_x</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ms</span><span class="token punctuation">.</span><span class="token plain">pos</span><span class="token punctuation">.</span><span class="token plain">x</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ms</span><span class="token punctuation">.</span><span class="token plain">pos</span><span class="token punctuation">.</span><span class="token plain">y</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">BEqu</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_buttons</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation">,</span><span class="token plain">ms</span><span class="token punctuation">.</span><span class="token plain">lb</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">BEqu</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_buttons</span><span class="token punctuation">,</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation">,</span><span class="token plain">ms</span><span class="token punctuation">.</span><span class="token plain">rb</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    DrawUI</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">dc</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ms</span><span class="token punctuation">.</span><span class="token plain">lb</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Left click</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      switch</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        case PS_NONE</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Only activate if we are in the drawing area</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">SIDE_BAR_WIDTH</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_x</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">GR_WIDTH</span><span class="token punctuation">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">TOP_BAR_HEIGHT</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">mouse_y</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain">GR_HEIGHT</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_BRUSH</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              switch</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">dft_action</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              case PS_BRUSH</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                StartBrushPaint</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                goto next</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              case PS_FILL</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                FillToolStart</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                goto next</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="color:rgb(130, 170, 255)">break</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        case PS_FILL</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//We go to the next as we haven&#x27;t release the left click yet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          goto next</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        case PS_BRUSH</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          ContinueBrushPaint</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          goto next</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        default</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         goto end_state</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(130, 170, 255)">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Left button is up</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      switch</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        case PS_BRUSH</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        case PS_FILL</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          goto end_state</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">ScanKey</span><span class="token punctuation">(</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">ch</span><span class="token punctuation">,</span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">sc</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">CH_CTRLF</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        gr_paint</span><span class="token punctuation">.</span><span class="token plain">dft_action</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_FILL</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        goto end_state</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">CH_CTRLU</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">PS_NONE</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           StartUndo</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          goto next</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(130, 170, 255)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">PS_UNDO</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           </span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//If we hold &#x27;u&#x27; down,be sure to not undo again to avoid repatingly undoing your work</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           goto next</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(130, 170, 255)">else</span><span class="token plain"> goto end_state</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">CH_CTRLS</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        SaveFileAs</span><span class="token punctuation">(</span><span class="token plain">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        goto next</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">CH_CTRLB</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        gr_paint</span><span class="token punctuation">.</span><span class="token plain">dft_action</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PS_BRUSH</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        goto end_state</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">CH_ESC</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        SaveFileAs</span><span class="token punctuation">(</span><span class="token plain">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="color:rgb(130, 170, 255)">break</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="color:rgb(130, 170, 255)">if</span><span class="token punctuation">(</span><span class="token plain">ch</span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain">CH_SHIFT_ESC</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="color:rgb(130, 170, 255)">break</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//Undo is triggered by button,so if no</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">end_state</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      switch</span><span class="token punctuation">(</span><span class="token plain">gr_paint</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        case PS_NONE</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="color:rgb(130, 170, 255)">break</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        case PS_BRUSH</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          EndBrushPaint</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="color:rgb(130, 170, 255)">break</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        case PS_FILL</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          FillToolEnd</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="color:rgb(130, 170, 255)">break</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        case PS_UNDO</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          UndoEnd</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token keyword" style="color:rgb(130, 170, 255)">break</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">next</span><span class="token punctuation">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin" style="color:rgb(207, 130, 255)">Refresh</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  GrPaintExit</span><span class="token punctuation">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Be sure to call the <code>GrPaint</code> function at the end</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GrPaint</span><span class="token punctuation">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="Painting" src="/assets/images/painting-6057ab1cdf77d986a29207905cb2ec14.jpg" width="1004" height="710" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">​</a></h2><p>Writing an app in TempleOS can be difficult at the start,but it get&#x27;s easier as you go along. And now you even have a means of creating <code>.GR</code> files for your games
If you want to view an Image,do</p><div class="language-holyc codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-holyc codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(195, 232, 141);font-style:italic">//DocPut is the current document</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(207, 130, 255)">DocGR</span><span class="token punctuation">(</span><span class="token builtin" style="color:rgb(207, 130, 255)">DocPut</span><span class="token punctuation">,</span><span class="token string" style="color:rgb(232, 208, 141)">&quot;DRAWING.GR&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/holyc/multic"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Multi-Threading</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#setupclasses-1" class="table-of-contents__link toc-highlight">Setup(Classes 1).</a></li><li><a href="#macros" class="table-of-contents__link toc-highlight">Macros</a></li><li><a href="#setupclasses-2" class="table-of-contents__link toc-highlight">Setup(Classes 2)</a></li><li><a href="#setupcircular-queues" class="table-of-contents__link toc-highlight">Setup(Circular Queues)</a></li><li><a href="#graphics-time" class="table-of-contents__link toc-highlight">Graphics time</a></li><li><a href="#user-input" class="table-of-contents__link toc-highlight">User Input</a></li><li><a href="#tool-timebrush" class="table-of-contents__link toc-highlight">Tool time(Brush)</a></li><li><a href="#tool-time-2fill-tool" class="table-of-contents__link toc-highlight">Tool Time 2(Fill tool)</a></li><li><a href="#tool-time-3undo" class="table-of-contents__link toc-highlight">Tool Time 3(Undo)</a></li><li><a href="#user-input-2menus" class="table-of-contents__link toc-highlight">User Input 2,Menus</a></li><li><a href="#creating-an-epic-background-pattern" class="table-of-contents__link toc-highlight">Creating an Epic Background Pattern</a></li><li><a href="#putting-it-all-togheter" class="table-of-contents__link toc-highlight">Putting it all Togheter</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Development</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.github.com/templeos-simplified/site-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item" position="right">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/TempleOS-Simplified/Site-Docs/graphs/contributors" target="_blank" rel="noopener noreferrer" class="footer__link-item" position="right">Contributors<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/templeosenjoyer" target="_blank" rel="noopener noreferrer" class="footer__link-item" position="center">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:xzntrc@fedora.email" target="_blank" rel="noopener noreferrer" class="footer__link-item" position="center">Email (Prefered)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Donate</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://donate.nami.org/give/197406/#!/donation/checkout?utm_source=globalNav&amp;utm_medium=website&amp;utm_campaign=DonationTracking&amp;c_src=WEBDGe" target="_blank" rel="noopener noreferrer" class="footer__link-item" position="center">National Alliance on Mental Health (US)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.sane.org.uk" target="_blank" rel="noopener noreferrer" class="footer__link-item" position="center">SANE (UK)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.sane.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item" position="center">SANE (AU)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Creative Commons Attribution 4.0 International © 2022 | Xzntrc</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f7de32a9.js"></script>
<script src="/assets/js/main.24907cfa.js"></script>
</body>
</html>